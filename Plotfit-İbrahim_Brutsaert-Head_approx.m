% Polynomial surface fitting of Ibrahim & Brutsaert (1961) chart.
% Can be used to approximate h/H value from x/L and Tau values.
% Resulting fitted function is not expected to represent to original
% solution. This is just a numerical approximation that can be preferred
% over eyeballing the charts.
% Author: Aykut Aladað 24.04.2020

clear all
clc

% % x values represent x/L axis
x = [0.0; 0.0; 0.0; 0.0; 0.0; 0.0; 0.0; 0.0; 
     0.1; 0.1; 0.1; 0.1; 0.1; 0.1; 0.1; 0.1; 
     0.2; 0.2; 0.2; 0.2; 0.2; 0.2; 0.2; 0.2; 
     0.3; 0.3; 0.3; 0.3; 0.3; 0.3; 0.3; 0.3; 
     0.4; 0.4; 0.4; 0.4; 0.4; 0.4; 0.4; 0.4; 
     0.5; 0.5; 0.5; 0.5; 0.5; 0.5; 0.5; 0.5; 
     0.6; 0.6; 0.6; 0.6; 0.6; 0.6; 0.6; 0.6; 
     0.7; 0.7; 0.7; 0.7; 0.7; 0.7; 0.7; 
     0.8; 0.8; 0.8; 0.8; 0.8; 0.8; 0.8; 
     0.9; 0.9; 0.9; 0.9; 0.9; 0.9; 0.9; 
     1.0; 1.0; 1.0; 1.0; 1.0; 1.0;             ];

% values for h/H axis 
h = [0.025; 0.050; 0.090; 0.125; 0.160; 0.200; 0.310; 0.410;
     0.070; 0.115; 0.190; 0.265; 0.345; 0.450; 0.575; 0.700;
     0.100; 0.170; 0.265; 0.380; 0.490; 0.620; 0.740; 0.835;
     0.120; 0.192; 0.330; 0.470; 0.600; 0.735; 0.835; 0.905;
     0.135; 0.215; 0.380; 0.530; 0.675; 0.815; 0.895; 0.950;
     0.150; 0.235; 0.415; 0.580; 0.735; 0.870; 0.940; 0.975;
     0.155; 0.245; 0.445; 0.612; 0.775; 0.910; 0.970; 0.990;
     0.160; 0.251; 0.465; 0.640; 0.805; 0.935; 0.985;
     0.163; 0.255; 0.480; 0.663; 0.822; 0.955; 0.995;
     0.165; 0.260; 0.492; 0.680; 0.845; 0.965; 1.000;
     0.167; 0.262; 0.500; 0.700; 0.855; 0.970;              ];

% Tau values.
tau = [5; 2.5; 1; 0.5; 0.25; 0.1; 0.05; 0.025; 
     5; 2.5; 1; 0.5; 0.25; 0.1; 0.05; 0.025; 
     5; 2.5; 1; 0.5; 0.25; 0.1; 0.05; 0.025; 
     5; 2.5; 1; 0.5; 0.25; 0.1; 0.05; 0.025; 
     5; 2.5; 1; 0.5; 0.25; 0.1; 0.05; 0.025; 
     5; 2.5; 1; 0.5; 0.25; 0.1; 0.05; 0.025; 
     5; 2.5; 1; 0.5; 0.25; 0.1; 0.05; 0.025; 
     5; 2.5; 1; 0.5; 0.25; 0.1; 0.05; 
     5; 2.5; 1; 0.5; 0.25; 0.1; 0.05; 
     5; 2.5; 1; 0.5; 0.25; 0.1; 0.05; 
     5; 2.5; 1; 0.5; 0.25; 0.1;             ];
 

% This is for visualizing the chart on 3D space.
sf = fit([x,h],tau,'poly55');
plot(sf,[x,h],tau)

% This is for fitting the needed function to approximate h/H
func = fit([x,tau],h,'poly55')



